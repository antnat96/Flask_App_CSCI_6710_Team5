<!DOCTYPE html>
<html>
    <head>
        <title>Vampires & Humans</title>

        <meta charset = "utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!--Bootstrap, jQuery, Google Charts-->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

        <!--Homemade Styles-->
        <style>
            body {
                background-color: silver;
            }
            .bot-line {
                border-bottom: 5px solid black;
            }
            .hold-height {
                min-height: 600px !important;
            }
            .send-right {
                text-align:right;
            }
            .top-line {
                border-top: 5px solid black;
            }
            .top-pad {
                padding-top: 30px;
            }
            
        </style>

        <script type="text/javascript">

            $(document).ready(function() {

                // Load the Google Charts packages & set the callback
                google.charts.load('current', {'packages':['corechart']});
                google.charts.setOnLoadCallback(drawChart);

                // Purpose: Draw the chart
                // Parameters: typeOfChart is the type of chart to draw, vampires and humans
                // is the number of each in the class, used to update the chart
                function drawChart(typeOfChart = "pie_select", vampires = 2, humans = 2) {
                    // Add data to the chart
                    var data = new google.visualization.DataTable();
                    data.addColumn('string', 'Type of Person');
                    data.addColumn('number', 'Number in Class');
                    data.addRows([['Vampires', vampires], ['Humans', humans]]);

                    var options = {'title':'Vampires & Humans in CSCI 6710', 'width':600, 'height':600, backgroundColor: 'silver'};

                    // Instantiate the appropriate type of chart within the chart_div
                    if (typeOfChart === "bar_select") {
                        var chart = new google.visualization.BarChart(document.getElementById('chart_div'));
                    }
                    else {
                        var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
                    }

                    // Show the chart and hide the table if function called after changing the view mode
                    if ($("#chart_div").hasClass("d-none") && !($("#table_div").hasClass("d-none"))) {
                        $("#chart_div").removeClass("d-none");
                        $("#table_div").addClass("d-none");
                    }

                    chart.draw(data, options);
                }
                
                // Handler for the "Add Student" button
                $("#add-student-button").on("click", function() {
                    addStudent();
                })
            
                // Purpose: Collect the student's information and add it to the table and chart information
                function addStudent() {
                    // Get the student's information
                    let firstName = $("#firstName").val();
                    let lastName = $("#lastName").val();
                    let garlic = ($("#garlic_yes").is(":checked") === true) ? true : false;
                    let shadow = ($("#shadow_yes").is(":checked") === true) ? true : false;
                    let complexion = ($("#complexion_yes").is(":checked") === true) ? true : false;

                    // Add the information to the table
                    var row = document.getElementById("students_table").insertRow(1);
                    var idCell = row.insertCell(0);
                    var firstNameCell = row.insertCell(1);
                    var lastNameCell = row.insertCell(2);
                    var garlicCell = row.insertCell(3);
                    var shadowCell = row.insertCell(4);
                    var complexionCell = row.insertCell(5);
                    var deleteCell = row.insertCell(6);
                    idCell.innerHTML = "";
                    firstNameCell.innerHTML = firstName;
                    lastNameCell.innerHTML = lastName;
                    garlicCell.innerHTML = (garlic === true) ? "Yes" : "No";
                    shadowCell.innerHTML = (shadow === true) ? "Yes" : "No";
                    complexionCell.innerHTML = (complexion === true) ? "Yes" : "No";
                    deleteCell.innerHTML = "<button class= 'remove-student-button btn btn-primary'>Delete</button>";
                }         

                // Handle the "Delete" button
                $(document).on('click', '.remove-student-button', function(){
                    // Get the closest row element's index and delete it
                    let row = $(this).closest('tr').index() + 1;
                    (row !== null && row !== undefined) ? document.getElementById("students_table").deleteRow(row) : window.alert("Oops! Having issues removing that student.");
                });

                // Handle the view mode change
                $("#select_view > a").on("click", function() {
                    // Get the selected type of chart
                    let typeOfChart = $(this).attr("id");
                    // If table, show it, otherwise hide it and draw the appropriate chart
                    (typeOfChart === "table_select") ? showTable() : drawChart(typeOfChart);
                })

                function showTable() {
                    $("#chart_div").addClass("d-none");
                    $("#table_div").removeClass("d-none");
                }

            });

        </script>
    </head>

    <body>
        <div class = "container bot-line">
            <h1>Students & Vampires</h1>
            <div class="dropdown send-right">
                <button class="btn btn-secondary dropdown-toggle" type="button" id="viewMode" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    View Mode
                </button>
                <div id = "select_view" class="dropdown-menu" aria-labelledby="viewMode">
                    <a id = "pie_select" class="dropdown-item">Pie Chart</a>
                    <a id = "table_select" class="dropdown-item">Table</a>
                    <a id = "bar_select" class="dropdown-item">Bar Graph</a>
                </div>
            </div>
            <div class = "row">
                <div class = "col-md-12 hold-height">
                    <div id= "chart_div"></div>
                    <div id = "table_div" class = "top-pad d-none">
                        <table id = "students_table" class="table table-striped">
                            <thead>
                              <tr>
                                <th scope="col">#</th>
                                <th scope="col">First</th>
                                <th scope="col">Last</th>
                                <th scope="col">Garlic?</th>
                                <th scope="col">Shadow?</th>
                                <th scope="col">Pale?</th>
                                <th scope="col"></th>
                              </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td></td>
                                    <td>John</td>
                                    <td>Smith</td>
                                    <td>No</td>
                                    <td>No</td>
                                    <td>Yes</td>
                                    <td><button class= "remove-student-button btn btn-primary">Delete</button></td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>Lee</td>
                                    <td>Johnson</td>
                                    <td>Yes</td>
                                    <td>No</td>
                                    <td>Yes</td>
                                    <td><button class= "remove-student-button btn btn-primary">Delete</button></td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>Emma</td>
                                    <td>Jackson</td>
                                    <td>Yes</td>
                                    <td>No</td>
                                    <td>Yes</td>
                                    <td><button class= "remove-student-button btn btn-primary">Delete</button></td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>Ava</td>
                                    <td>Robinson</td>
                                    <td>No</td>
                                    <td>Yes</td>
                                    <td>No</td>
                                    <td><button class= "remove-student-button btn btn-primary">Delete</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class = "container top-line">
            <div class = "row">
                <div class = "col-md-6">
                    <h2>Enter the Student's Information</h2>
                </div>
            </div>
            <br>
            <form>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="firstName">First Name</label>
                    <input type="text" class="form-control" id="firstName" placeholder = "John">
                  </div>
                  <div class="form-group col-md-6">
                    <label for="lastName">Last Name</label>
                    <input type="text" class="form-control" id="lastName" placeholder = "Smith">
                  </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-12">
                        <div class="form-check">
                            <b>Does the student like garlic?</b><br>
                            <div class="radio">
                                <label><input type="radio" name="garlic" id="garlic_yes" checked>Yes</label>
                            </div>
                            <div class="radio">
                                <label><input type="radio" name="garlic" id="garlic_no">No</label>
                            </div>
                        </div>
                    </div>                
                </div>
                <div class="form-row">
                    <div class="form-group col-md-12">
                        <div class="form-check">
                            <b>Does the student cast a shadow?</b><br>
                            <div class="radio">
                                <label><input type="radio" name="shadow" id="shadow_yes" checked>Yes</label>
                            </div>
                            <div class="radio">
                                <label><input type="radio" name="shadow" id="shadow_no">No</label>
                            </div>
                        </div>
                    </div>                
                </div>
                <div class="form-row">
                    <div class="form-group col-md-12">
                        <div class="form-check">
                            <b>Is the student pale?</b><br>
                            <div class="radio">
                                <label><input type="radio" name="complexion" id="complexion_yes" checked>Yes</label>
                            </div>
                            <div class="radio">
                                <label><input type="radio" name="complexion" id="complexion_no">No</label>
                            </div>
                        </div>
                    </div>                
                </div>
            </form>
            <button id = "add-student-button" class="btn btn-primary">Add Student</button>

        </div>
    </body>
</html>